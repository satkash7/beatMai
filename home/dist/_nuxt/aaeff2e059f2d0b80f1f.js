(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{571:function(e,t,r){"use strict";r.r(t);var n=r(7),o=(r(104),r(40),{name:"reset-component",layout:"user",mixins:[r(70).a],data:function(){return{step:1,email:"",token:"",password:"",confirmPassword:"",success:!1,verified:!1}},methods:{sendResetRequest:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$axios.post("/user/password/request-reset",{email:e.email});case 3:200===t.sent.data.status_code?(e.verified=!0,e.step=2):alert("Invalid or unknown email address! Please enter a valid email."),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.error("Error sending reset request",t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},verifyCode:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$axios.post("/user/password/verify-token",{token:e.token,email:e.email});case 3:200===(r=t.sent).data.status_code?e.step=3:401===r.data.status_code?(alert("Expired Code! Please enter a valid code."),e.step=1):(alert("Invalid code! Please enter a valid code."),e.$router.push("/password-reset")),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.error("Error sending reset request",t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},resetPassword:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.verified=!1,e.password===e.confirmPassword){t.next=4;break}return alert("Passwords do not match!"),t.abrupt("return");case 4:return t.prev=4,t.next=7,e.$axios.post("/user/password/reset",{token:e.token,email:e.email,password:e.password});case 7:200===t.sent.data.status_code?(e.success=!0,setTimeout((function(){e.$router.push("/u")}),7e3)):alert("Unexpected error! Please try again."),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(4),console.error("Error resetting password",t.t0);case 14:case"end":return t.stop()}}),t,null,[[4,11]])})))()}}}),l=r(0),component=Object(l.a)(o,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"container mx-auto px2 py-4"},[t("div",{staticClass:"max-w-md mx-auto bg-white p-3 rounded-lg shadow-md"},[t("h2",{staticClass:"text-xl font-semibold text-center mb-4"},[e._v("Reset Your Password")]),e._v(" "),e.success?t("div",{staticClass:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative",attrs:{role:"alert"}},[t("strong",{staticClass:"font-bold text-green-700"},[e._v("Success!")]),e._v(" Password reset successful! \n      "),t("hr"),e._v(" "),e._m(0)]):e._e(),e._v(" "),e.verified?t("div",{staticClass:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative",attrs:{role:"alert"}},[t("strong",{staticClass:"font-bold text-green-700"},[e._v("Verification!")]),e._v(" "),t("span",{staticClass:"block sm:inline"},[e._v("Please check your inbox/spam folder. Reset code sent to your email. Validity:1h")])]):e._e(),e._v(" "),1==e.step?t("form",{on:{submit:function(t){return t.preventDefault(),e.sendResetRequest.apply(null,arguments)}}},[t("label",{staticClass:"block mb-2"},[e._v("Enter your email")]),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],staticClass:"w-full p-2 border rounded",attrs:{type:"email",required:""},domProps:{value:e.email},on:{input:function(t){t.target.composing||(e.email=t.target.value)}}}),e._v(" "),t("button",{staticClass:"mt-4 w-full bg-blue-800 text-white p-2 rounded",attrs:{type:"submit"}},[e._v("Request Password Reset")])]):e._e(),e._v(" "),2==e.step?t("form",{on:{submit:function(t){return t.preventDefault(),e.verifyCode.apply(null,arguments)}}},[t("label",{staticClass:"block mb-2"},[e._v("Enter 6-digit code")]),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.token,expression:"token"}],staticClass:"w-full p-2 border rounded",attrs:{type:"text",maxlength:"6",required:""},domProps:{value:e.token},on:{input:function(t){t.target.composing||(e.token=t.target.value)}}}),e._v(" "),t("button",{staticClass:"mt-4 w-full bg-blue-800 text-white p-2 rounded",attrs:{type:"submit"}},[e._v("Verify Code")])]):e._e(),e._v(" "),3==e.step?t("form",{on:{submit:function(t){return t.preventDefault(),e.resetPassword.apply(null,arguments)}}},[t("label",{staticClass:"block mb-2"},[e._v("New Password")]),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],staticClass:"w-full p-2 border rounded",attrs:{type:"password",required:""},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}}),e._v(" "),t("label",{staticClass:"block mb-2 mt-2"},[e._v("Confirm Password")]),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.confirmPassword,expression:"confirmPassword"}],staticClass:"w-full p-2 border rounded",attrs:{type:"password",required:""},domProps:{value:e.confirmPassword},on:{input:function(t){t.target.composing||(e.confirmPassword=t.target.value)}}}),e._v(" "),t("button",{staticClass:"mt-4 w-full bg-blue-800 text-white p-2 rounded",attrs:{type:"submit"}},[e._v("Reset Password")])]):e._e()])])}),[function(){var e=this._self._c;return e("span",{staticClass:"block sm:inline"},[e("a",{attrs:{href:"/u"}},[e("b",[this._v("Click here to login")])])])}],!1,null,null,null);t.default=component.exports}}]);